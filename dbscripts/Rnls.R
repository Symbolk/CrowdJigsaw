library(ggplot2)
library(AICcmodavg)

x <- c(1,1,1,1,1,1,1,1,1,1,2,2,2,3,4,5,5,5,5,5,6,6,6,6,6,7,7,8,9,10,11,11,11,11,13,15,16,17,17,19,20,20,21,25,25,26,27,28,29,31,34,34,35,43,62,69,101)
y <- c(1167.2144,1472.4273,1708.4875,1775.5425,2460.0000,2693.6687,2816.5748,3486.3138,3974.8800,4185.0862,1566.1869,2078.8052,2500.0373,1927.2898,1266.4946,1480.0677,1526.5672,1534.2063,1615.0000,1821.7919,1052.4784,1109.3832,1128.3714,1581.6377,1963.4326,745.0128,1044.4060,1052.0000,1144.3428,1219.1988,805.1287,878.1721,1097.2635,1164.2974,711.0142,789.4855,719.0000,497.5910,794.9515,627.1521,666.0405,747.2766,706.6838,588.3236,618.5469,619.5617,563.9961,396.0992,309.8824,307.4191,223.6034,686.0000,406.0833,338.9607,174.6645,610.0000,94.0709)

SST = sum((y - mean(y)) ^ 2) 

m1 <- nls(y ~ b1 * x ^ b2, start = list(b1=3000, b2=-0.5))
m2 <- nls(y ~ N * (x ^ (a + b * x)), start = list(N=3000, a=-0.5, b=0))
m3 <- nls(y ~ a * log(x, exp(1)) + b, start = list(a = -600, b = 3000))
m4 <- nls(y ~ b1 * x ^ b2 + b3, start = list(b1=3000, b2=-0.5, b3=0))
m5 <- nls(y ~ b1 * x ^ b2 + b3 * x, start = list(b1=3000, b2=-0.5, b3=1))
m6 <- nls(y ~ (a * x + b) * x ^ k, start = list(a = 1, b = 3000, k=-0.5))

m7 <- nls(y ~ b1 * (x ^ b2 + b3) / x, start = list(b1=3000, b2 = -1, b3 = 1000))
m8 <- nls(y ~ b1 * log(b2 * x, exp(1)) / x, start = list(b1=3000, b2 = 1))
m9 <- nls(y ~ b1 * log(x + b2, exp(1)) / x, start = list(b1=3000, b2 = 1))
m10 <- nls(y ~ b1 * exp(x * b2) / x, start = list(b1=3000, b2 = 0))
m11 <- nls(y ~ b1 * exp(x * b2), start = list(b1=3000, b2 = 0))



p <- ggplot(data.frame(x=x, y=y), aes(x, y))
p+geom_point(size=3)+geom_line(aes(x,fitted(m1)),col='red')+geom_line(aes(x,fitted(m2)),col='blue')+geom_line(aes(x,fitted(m3)),col='green')+geom_line(aes(x,fitted(m4)),col='black')

AIC(m1, m2, m3, m4)
AICc(m1)
AICc(m2)
AICc(m3)
AICc(m4)
